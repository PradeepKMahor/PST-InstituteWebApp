<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Institute Management System</title>
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --primary-color: #4f46e5;
            --primary-hover: #4338ca;
            --secondary-color: #64748b;
            --bg-light: #f1f5f9;
            --surface-white: #ffffff;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --danger: #ef4444;
            --success: #10b981;
            --border-radius: 8px;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--bg-light); color: var(--text-dark); height: 100vh; overflow: hidden; }

        /* --- UTILITIES --- */
        .hidden { display: none !important; }
        .btn { padding: 10px 20px; border: none; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: 0.2s; }
        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-primary:hover { background-color: var(--primary-hover); }
        .btn-outline { background-color: transparent; border: 1px solid var(--secondary-color); color: var(--secondary-color); }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .gap-4 { gap: 1rem; }
        .w-full { width: 100%; }

        /* --- LOGIN PAGE --- */
        #login-view {
            height: 100vh; display: flex; justify-content: center; align-items: center;
            background: linear-gradient(135deg, #4f46e5 0%, #818cf8 100%);
        }
        .login-card {
            background: var(--surface-white); padding: 2.5rem; border-radius: 12px; width: 100%; max-width: 400px;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }
        .login-header { text-align: center; margin-bottom: 2rem; }
        .login-header h2 { color: var(--primary-color); font-size: 1.8rem; }
        .form-group { margin-bottom: 1.2rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--text-light); }
        .form-control {
            width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: var(--border-radius);
            font-size: 1rem; outline: none;
        }
        .form-control:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }

        /* --- DASHBOARD LAYOUT --- */
        .dashboard-container { display: flex; height: 100vh; }
        
        /* Sidebar */
        .sidebar {
            width: 260px; background-color: var(--surface-white); border-right: 1px solid #e2e8f0;
            display: flex; flex-direction: column;
        }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid #e2e8f0; }
        .sidebar-header h3 { color: var(--primary-color); display: flex; align-items: center; gap: 10px; }
        .nav-links { padding: 1rem; list-style: none; flex: 1; }
        .nav-item { margin-bottom: 0.5rem; }
        .nav-link {
            display: flex; align-items: center; padding: 12px 16px; text-decoration: none;
            color: var(--text-light); border-radius: var(--border-radius); font-weight: 500;
        }
        .nav-link:hover, .nav-link.active { background-color: #eef2ff; color: var(--primary-color); }
        .user-profile { padding: 1rem; border-top: 1px solid #e2e8f0; display: flex; align-items: center; gap: 10px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background-color: #e2e8f0; }

        /* Main Content */
        .main-content { flex: 1; padding: 2rem; overflow-y: auto; }
        .page-header { margin-bottom: 2rem; }
        .page-title { font-size: 1.8rem; font-weight: 700; color: var(--text-dark); }
        
        /* Cards & Stats */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card {
            background: var(--surface-white); padding: 1.5rem; border-radius: var(--border-radius);
            box-shadow: var(--shadow); border: 1px solid #e2e8f0;
        }
        .stat-label { color: var(--text-light); font-size: 0.9rem; margin-bottom: 0.5rem; }
        .stat-value { font-size: 2rem; font-weight: 700; color: var(--text-dark); }
        .stat-value.due { color: var(--danger); }
        .stat-value.success { color: var(--success); }

        /* Tables */
        .table-container { background: var(--surface-white); border-radius: var(--border-radius); box-shadow: var(--shadow); overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 1rem; text-align: left; border-bottom: 1px solid #f1f5f9; }
        th { background-color: #f8fafc; font-weight: 600; color: var(--text-light); }
        tr:hover { background-color: #f8fafc; }
        
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
        .badge-success { background-color: #dcfce7; color: #166534; }
        .badge-warning { background-color: #fef9c3; color: #854d0e; }
        .badge-danger { background-color: #fee2e2; color: #991b1b; }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;
            z-index: 100; opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .modal-overlay.open { opacity: 1; pointer-events: all; }
        .modal { background: white; padding: 2rem; border-radius: 12px; width: 400px; transform: translateY(20px); transition: 0.3s; }
        .modal-overlay.open .modal { transform: translateY(0); }
        .modal-title { font-size: 1.25rem; margin-bottom: 1.5rem; }
        .amount-display { font-size: 2rem; font-weight: bold; color: var(--primary-color); text-align: center; margin: 1rem 0; }

    </style>
</head>
<body>

    <!-- === LOGIN VIEW === -->
    <section id="login-view">
        <div class="login-card">
            <div class="login-header">
                <h2>Institute IMS This is Dev : Pradeep Mahor</h2>
                <p style="color:var(--text-light)">Enter your credentials to access</p>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="email" class="form-control" placeholder="student@institute.com" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="role" class="form-control">
                        <option value="student">Student</option>
                        <option value="admin">Admin / Staff</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary w-full">Sign In</button>
            </form>
            <p style="margin-top:1rem; font-size:0.8rem; color:var(--text-light); text-align:center;">
                (Demo: Use any email/password)
            </p>
        </div>
    </section>

    <!-- === DASHBOARD VIEW (Shared for Admin & Student) === -->
    <section id="dashboard-view" class="hidden">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>ðŸŽ“ IMS Portal</h3>
            </div>
            <ul class="nav-links">
                <li class="nav-item">
                    <a href="#" class="nav-link active" onclick="switchTab('home')">Dashboard</a>
                </li>
                <!-- Links specific to roles would be toggled via JS -->
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('students')">Students</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('fees')">Fee Management</a>
                </li>
            </ul>
            <div class="user-profile">
                <div class="avatar"></div>
                <div>
                    <div style="font-weight:600" id="user-name-display">John Doe</div>
                    <div style="font-size:0.8rem; color:var(--text-light)" id="user-role-display">Student</div>
                </div>
                <button onclick="logout()" style="margin-left:auto; border:none; background:none; cursor:pointer; color:var(--danger)">
                    Logout
                </button>
            </div>
        </aside>

        <main class="main-content">
            <!-- 1. HOME TAB -->
            <div id="tab-home">
                <div class="page-header">
                    <h1 class="page-title">Dashboard Overview</h1>
                    <p style="color:var(--text-light)">Welcome back to your student portal.</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Batch</div>
                        <div class="stat-value" style="font-size:1.5rem">CS-2024-A</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Fees</div>
                        <div class="stat-value">$1,500</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Paid Amount</div>
                        <div class="stat-value success">$500</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Due Amount</div>
                        <div class="stat-value due">$1,000</div>
                    </div>
                </div>

                <h3>Recent Activity</h3>
                <div class="table-container" style="margin-top:1rem">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="activity-table-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 2. STUDENTS TAB (Admin Only) -->
            <div id="tab-students" class="hidden">
                <div class="page-header flex justify-between items-center">
                    <div>
                        <h1 class="page-title">Student Directory</h1>
                        <p style="color:var(--text-light)">Manage enrolled students.</p>
                    </div>
                    <button class="btn btn-primary">+ Add Student</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Roll No</th>
                                <th>Batch</th>
                                <th>Fees Paid</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="student-list-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 3. FEES TAB -->
            <div id="tab-fees" class="hidden">
                <div class="page-header">
                    <h1 class="page-title">Fee Management</h1>
                    <p style="color:var(--text-light)">View and pay outstanding dues.</p>
                </div>
                
                <div class="stat-card" style="max-width: 600px; margin: 0 auto;">
                    <div class="flex justify-between items-center" style="margin-bottom: 1rem">
                        <div>
                            <h3>Semester 1 Tuition</h3>
                            <p style="color:var(--text-light)">Due Date: Oct 30, 2024</p>
                        </div>
                        <span class="badge badge-danger">Pending</span>
                    </div>
                    <div style="border-top: 1px solid #f1f5f9; padding-top:1rem; display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <span style="font-size:0.9rem; color:var(--text-light)">Amount Due</span>
                            <div style="font-size:1.5rem; font-weight:bold">$500.00</div>
                        </div>
                        <button class="btn btn-primary" onclick="openPaymentModal(500)">Pay Now</button>
                    </div>
                </div>
            </div>
        </main>
    </section>

    <!-- === PAYMENT MODAL === -->
    <div class="modal-overlay" id="payment-modal">
        <div class="modal">
            <h3 class="modal-title">Secure Payment</h3>
            <p style="color:var(--text-light); text-align:center">Completing payment for Institute Fees</p>
            
            <div class="amount-display">$<span id="pay-amount">0</span></div>
            
            <form id="payment-form">
                <div class="form-group">
                    <label>Card Number</label>
                    <input type="text" class="form-control" placeholder="0000 0000 0000 0000" required>
                </div>
                <div class="flex gap-4">
                    <div class="form-group w-full">
                        <label>Expiry</label>
                        <input type="text" class="form-control" placeholder="MM/YY" required>
                    </div>
                    <div class="form-group w-full">
                        <label>CVV</label>
                        <input type="text" class="form-control" placeholder="123" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary w-full">Confirm Payment</button>
                <button type="button" class="btn btn-outline w-full" style="margin-top:0.5rem" onclick="closePaymentModal()">Cancel</button>
            </form>
        </div>
    </div>

    <script>
        /* --- MOCK DATA & STATE --- 
           This simulates the data that would normally come from the SQL Database via API calls 
        */
        const MOCK_DB = {
            user: null, // Set on login
            transactions: [
                { id: 1, date: '2023-09-01', desc: 'Admission Fee', amount: 500, status: 'Paid' },
                { id: 2, date: '2023-09-15', desc: 'Library Deposit', amount: 50, status: 'Paid' }
            ],
            students: [
                { id: 101, name: 'Alice Johnson', roll: 'CS001', batch: 'CS-2024-A', paid: 1500 },
                { id: 102, name: 'Bob Smith', roll: 'CS002', batch: 'CS-2024-A', paid: 500 },
                { id: 103, name: 'Charlie Brown', roll: 'CS003', batch: 'CS-2024-B', paid: 0 },
            ]
        };

        // --- DOM ELEMENTS ---
        const loginView = document.getElementById('login-view');
        const dashboardView = document.getElementById('dashboard-view');
        const loginForm = document.getElementById('login-form');
        const paymentModal = document.getElementById('payment-modal');
        const paymentForm = document.getElementById('payment-form');

        // --- AUTHENTICATION LOGIC ---
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const role = document.getElementById('role').value;
            
            // Mock Login Logic
            MOCK_DB.user = {
                name: email.split('@')[0], // Use email prefix as name
                role: role,
                email: email
            };

            // Update UI
            document.getElementById('user-name-display').textContent = MOCK_DB.user.name;
            document.getElementById('user-role-display').textContent = role.toUpperCase();

            // Toggle Views
            loginView.classList.add('hidden');
            dashboardView.classList.remove('hidden');

            // Load Initial Data
            loadDashboardData();
            
            // Hide 'Students' tab if user is a student (Security Logic)
            if(role === 'student') {
                document.querySelector('a[onclick="switchTab(\'students\')"]').parentElement.classList.add('hidden');
                switchTab('home'); // Force to home
            } else {
                switchTab('students'); // Admin goes to student list
            }
        });

        function logout() {
            MOCK_DB.user = null;
            dashboardView.classList.add('hidden');
            loginView.classList.remove('hidden');
            loginForm.reset();
        }

        // --- NAVIGATION LOGIC ---
        function switchTab(tabName) {
            // Hide all tabs
            ['home', 'students', 'fees'].forEach(t => {
                document.getElementById(`tab-${t}`).classList.add('hidden');
            });
            // Show selected tab
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
            
            // Update Sidebar Active State
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- DATA RENDERING ---
        function loadDashboardData() {
            const tbody = document.getElementById('activity-table-body');
            tbody.innerHTML = '';
            
            MOCK_DB.transactions.forEach(tx => {
                const tr = document.createElement('tr');
                let badgeClass = tx.status === 'Paid' ? 'badge-success' : 'badge-danger';
                
                tr.innerHTML = `
                    <td>${tx.date}</td>
                    <td>${tx.desc}</td>
                    <td>$${tx.amount}</td>
                    <td><span class="badge ${badgeClass}">${tx.status}</span></td>
                `;
                tbody.appendChild(tr);
            });

            // Populate Student List (for Admin)
            const studentBody = document.getElementById('student-list-body');
            studentBody.innerHTML = '';
            MOCK_DB.students.forEach(st => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${st.id}</td>
                    <td>${st.name}</td>
                    <td>${st.roll}</td>
                    <td>${st.batch}</td>
                    <td>$${st.paid}</td>
                    <td>
                        <button class="btn btn-outline" style="padding:4px 8px; font-size:0.8rem">Edit</button>
                    </td>
                `;
                studentBody.appendChild(tr);
            });
        }

        // --- PAYMENT MODAL LOGIC ---
        function openPaymentModal(amount) {
            document.getElementById('pay-amount').innerText = amount;
            paymentModal.classList.add('open');
        }

        function closePaymentModal() {
            paymentModal.classList.remove('open');
            paymentForm.reset();
        }

        paymentForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = paymentForm.querySelector('button[type="submit"]');
            const originalText = btn.innerText;
            
            // Simulate Processing
            btn.innerText = "Processing...";
            btn.disabled = true;

            setTimeout(() => {
                // Success State
                closePaymentModal();
                alert("Payment Successful! Receipt generated.");
                
                // Add to Mock History (Simulating DB Update via SP)
                const amount = document.getElementById('pay-amount').innerText;
                MOCK_DB.transactions.unshift({
                    id: MOCK_DB.transactions.length + 1,
                    date: new Date().toISOString().split('T')[0],
                    desc: 'Online Fee Payment',
                    amount: parseInt(amount),
                    status: 'Paid'
                });
                
                loadDashboardData(); // Refresh UI
                
                btn.innerText = originalText;
                btn.disabled = false;
            }, 1500);
        });

    </script>
</body>
</html>
